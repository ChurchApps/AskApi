{
  "openapi": "3.0.0",
  "info": {
    "title": "Giving API",
    "description": "API for managing donations, payment processing, subscriptions, and financial transactions",
    "version": "1.0.0"
  },
  "servers": [
    {
      "url": "/",
      "description": "API base URL"
    }
  ],
  "security": [
    {
      "bearerAuth": []
    }
  ],
  "paths": {
    "/customers/{id}": {
      "get": {
        "tags": ["Customers"],
        "summary": "Get customer by ID",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Customer"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.viewSummary"]
          }
        ]
      },
      "delete": {
        "tags": ["Customers"],
        "summary": "Delete customer",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.edit"]
          }
        ]
      }
    },
    "/customers/{id}/subscriptions": {
      "get": {
        "tags": ["Customers"],
        "summary": "Get customer subscriptions",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Stripe subscription list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.viewSummary"]
          }
        ]
      }
    },
    "/customers": {
      "get": {
        "tags": ["Customers"],
        "summary": "Get all customers",
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Customer"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.viewSummary"]
          }
        ]
      }
    },
    "/donate/log": {
      "post": {
        "tags": ["Donations"],
        "summary": "Log a donation",
        "description": "Requires valid church secret key",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "donation": {
                    "$ref": "#/components/schemas/Donation"
                  },
                  "fundData": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "string"
                      },
                      "amount": {
                        "type": "number"
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/FundDonation"
                  }
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/donate/webhook/{provider}": {
      "post": {
        "tags": ["Donations"],
        "summary": "Handle payment provider webhooks",
        "parameters": [
          {
            "name": "provider",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "churchId",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Webhook processed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/donate/charge": {
      "post": {
        "tags": ["Donations"],
        "summary": "Process one-time donation",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Donation"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Stripe charge response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        }
      }
    },
    "/donate/subscribe": {
      "post": {
        "tags": ["Donations"],
        "summary": "Create recurring donation subscription",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Stripe subscription response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        }
      }
    },
    "/donate/fee": {
      "post": {
        "tags": ["Donations"],
        "summary": "Calculate processing fees",
        "parameters": [
          {
            "name": "churchId",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "type": {
                    "type": "string"
                  },
                  "amount": {
                    "type": "number"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Calculated fee",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "calculatedFee": {
                      "type": "number"
                    }
                  }
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/donate/captcha-verify": {
      "post": {
        "tags": ["Donations"],
        "summary": "Verify reCAPTCHA token",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "token": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Captcha verification response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "response": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/donationbatches/{id}": {
      "get": {
        "tags": ["Donation Batches"],
        "summary": "Get donation batch by ID",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DonationBatch"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.viewSummary"]
          }
        ]
      },
      "delete": {
        "tags": ["Donation Batches"],
        "summary": "Delete donation batch and related donations",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.edit"]
          }
        ]
      }
    },
    "/donationbatches": {
      "get": {
        "tags": ["Donation Batches"],
        "summary": "Get all donation batches",
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/DonationBatch"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.viewSummary"]
          }
        ]
      },
      "post": {
        "tags": ["Donation Batches"],
        "summary": "Create or update donation batches",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/DonationBatch"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/DonationBatch"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.edit"]
          }
        ]
      }
    },
    "/donations/testEmail": {
      "get": {
        "tags": ["Donations"],
        "summary": "Test email functionality",
        "responses": {
          "200": {
            "description": "Test result",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/donations/summary": {
      "get": {
        "tags": ["Donations"],
        "summary": "Get donation summary and reports",
        "parameters": [
          {
            "name": "startDate",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "date"
            }
          },
          {
            "name": "endDate",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "date"
            }
          },
          {
            "name": "type",
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Donation summary",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.viewSummary"]
          }
        ]
      }
    },
    "/donations/my": {
      "get": {
        "tags": ["Donations"],
        "summary": "Get current user's donations",
        "responses": {
          "200": {
            "description": "User's donations",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Donation"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/donations/{id}": {
      "get": {
        "tags": ["Donations"],
        "summary": "Get donation by ID",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Donation"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.view"]
          }
        ]
      },
      "delete": {
        "tags": ["Donations"],
        "summary": "Delete donation",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.edit"]
          }
        ]
      }
    },
    "/donations": {
      "get": {
        "tags": ["Donations"],
        "summary": "Get donations with filters",
        "parameters": [
          {
            "name": "personId",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "batchId",
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Donation"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.view"]
          }
        ]
      },
      "post": {
        "tags": ["Donations"],
        "summary": "Create or update donations",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Donation"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Donation"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.edit"]
          }
        ]
      }
    },
    "/eventLog/{id}": {
      "get": {
        "tags": ["Event Logs"],
        "summary": "Get event log by ID",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EventLog"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.viewSummary"]
          }
        ]
      },
      "delete": {
        "tags": ["Event Logs"],
        "summary": "Delete event log",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.edit"]
          }
        ]
      }
    },
    "/eventLog/type/{type}": {
      "get": {
        "tags": ["Event Logs"],
        "summary": "Get event logs by type",
        "parameters": [
          {
            "name": "type",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/EventLog"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.viewSummary"]
          }
        ]
      }
    },
    "/eventLog": {
      "get": {
        "tags": ["Event Logs"],
        "summary": "Get all event logs",
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/EventLog"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.viewSummary"]
          }
        ]
      },
      "post": {
        "tags": ["Event Logs"],
        "summary": "Create or update event logs",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/EventLog"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/EventLog"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.edit"]
          }
        ]
      }
    },
    "/funds/{id}": {
      "get": {
        "tags": ["Funds"],
        "summary": "Get fund by ID",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Fund"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.viewSummary"]
          }
        ]
      },
      "delete": {
        "tags": ["Funds"],
        "summary": "Delete fund",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.edit"]
          }
        ]
      }
    },
    "/funds/churchId/{churchId}": {
      "get": {
        "tags": ["Funds"],
        "summary": "Get funds for specific church",
        "parameters": [
          {
            "name": "churchId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Fund"
                  }
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/funds": {
      "get": {
        "tags": ["Funds"],
        "summary": "Get all funds",
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Fund"
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Funds"],
        "summary": "Create or update funds",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Fund"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Fund"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.edit"]
          }
        ]
      }
    },
    "/funddonations/my": {
      "get": {
        "tags": ["Fund Donations"],
        "summary": "Get current user's fund donations",
        "responses": {
          "200": {
            "description": "User's fund donations",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/FundDonation"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/funddonations/{id}": {
      "get": {
        "tags": ["Fund Donations"],
        "summary": "Get fund donation by ID",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FundDonation"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.view"]
          }
        ]
      },
      "delete": {
        "tags": ["Fund Donations"],
        "summary": "Delete fund donation",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.edit"]
          }
        ]
      }
    },
    "/funddonations": {
      "get": {
        "tags": ["Fund Donations"],
        "summary": "Get fund donations with filters",
        "parameters": [
          {
            "name": "donationId",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "personId",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "fundId",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "startDate",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "date"
            }
          },
          {
            "name": "endDate",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "date"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/FundDonation"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.view"]
          }
        ]
      },
      "post": {
        "tags": ["Fund Donations"],
        "summary": "Create or update fund donations",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/FundDonation"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/FundDonation"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.edit"]
          }
        ]
      }
    },
    "/gateways/churchId/{churchId}": {
      "get": {
        "tags": ["Gateways"],
        "summary": "Get gateways for specific church",
        "parameters": [
          {
            "name": "churchId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Gateway"
                  }
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/gateways/configured/{churchId}": {
      "get": {
        "tags": ["Gateways"],
        "summary": "Check if gateway is configured",
        "parameters": [
          {
            "name": "churchId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Configuration status",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "configured": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/gateways/{id}": {
      "get": {
        "tags": ["Gateways"],
        "summary": "Get gateway by ID",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Gateway"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["settings.edit"]
          }
        ]
      },
      "patch": {
        "tags": ["Gateways"],
        "summary": "Update gateway",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Gateway"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated gateway",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Gateway"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["settings.edit"]
          }
        ]
      },
      "delete": {
        "tags": ["Gateways"],
        "summary": "Delete gateway and remove Stripe webhooks",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["settings.edit"]
          }
        ]
      }
    },
    "/gateways": {
      "get": {
        "tags": ["Gateways"],
        "summary": "Get all gateways",
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Gateway"
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Gateways"],
        "summary": "Create or update gateways and create Stripe webhooks",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Gateway"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Gateway"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["settings.edit"]
          }
        ]
      }
    },
    "/paymentmethods/personid/{id}": {
      "get": {
        "tags": ["Payment Methods"],
        "summary": "Get person's payment methods",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Stripe payment methods",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.view"]
          }
        ]
      }
    },
    "/paymentmethods/addcard": {
      "post": {
        "tags": ["Payment Methods"],
        "summary": "Add credit card",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Payment method and customer ID",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "paymentMethod": {
                      "type": "object"
                    },
                    "customerId": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/paymentmethods/updatecard": {
      "post": {
        "tags": ["Payment Methods"],
        "summary": "Update credit card",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Stripe response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.edit"]
          }
        ]
      }
    },
    "/paymentmethods/addbankaccount": {
      "post": {
        "tags": ["Payment Methods"],
        "summary": "Add bank account",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Stripe response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.edit"]
          }
        ]
      }
    },
    "/paymentmethods/updatebank": {
      "post": {
        "tags": ["Payment Methods"],
        "summary": "Update bank account",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Stripe response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.edit"]
          }
        ]
      }
    },
    "/paymentmethods/verifybank": {
      "post": {
        "tags": ["Payment Methods"],
        "summary": "Verify bank account with micro-deposits",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Stripe response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.edit"]
          }
        ]
      }
    },
    "/paymentmethods/{id}/{customerid}": {
      "delete": {
        "tags": ["Payment Methods"],
        "summary": "Delete payment method",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "customerid",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.edit"]
          }
        ]
      }
    },
    "/subscriptions/{id}": {
      "get": {
        "tags": ["Subscriptions"],
        "summary": "Get subscription by ID",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.viewSummary"]
          }
        ]
      },
      "delete": {
        "tags": ["Subscriptions"],
        "summary": "Delete subscription",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.edit"]
          }
        ]
      }
    },
    "/subscriptions": {
      "get": {
        "tags": ["Subscriptions"],
        "summary": "Get all subscriptions",
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.viewSummary"]
          }
        ]
      },
      "post": {
        "tags": ["Subscriptions"],
        "summary": "Update subscriptions",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "object"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Stripe responses",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.edit"]
          }
        ]
      }
    },
    "/subscriptionfunds/{id}": {
      "get": {
        "tags": ["Subscription Funds"],
        "summary": "Get subscription fund by ID",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SubscriptionFund"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.viewSummary"]
          }
        ]
      },
      "delete": {
        "tags": ["Subscription Funds"],
        "summary": "Delete subscription fund",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.edit"]
          }
        ]
      }
    },
    "/subscriptionfunds": {
      "get": {
        "tags": ["Subscription Funds"],
        "summary": "Get subscription funds",
        "parameters": [
          {
            "name": "subscriptionId",
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/SubscriptionFund"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.view"]
          }
        ]
      }
    },
    "/subscriptionfunds/subscription/{id}": {
      "delete": {
        "tags": ["Subscription Funds"],
        "summary": "Delete all funds for subscription",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearerAuth": [],
            "permissions": ["donations.edit"]
          }
        ]
      }
    }
  },
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "Customer": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "churchId": {
            "type": "string"
          },
          "personId": {
            "type": "string"
          },
          "stripeCustomerId": {
            "type": "string"
          },
          "email": {
            "type": "string"
          }
        }
      },
      "Donation": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "churchId": {
            "type": "string"
          },
          "batchId": {
            "type": "string"
          },
          "personId": {
            "type": "string"
          },
          "donationDate": {
            "type": "string",
            "format": "date"
          },
          "amount": {
            "type": "number"
          },
          "method": {
            "type": "string"
          },
          "methodDetails": {
            "type": "string"
          },
          "notes": {
            "type": "string"
          }
        }
      },
      "DonationBatch": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "churchId": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "batchDate": {
            "type": "string",
            "format": "date"
          },
          "totalAmount": {
            "type": "number"
          }
        }
      },
      "EventLog": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "churchId": {
            "type": "string"
          },
          "eventType": {
            "type": "string"
          },
          "eventDate": {
            "type": "string",
            "format": "date-time"
          },
          "details": {
            "type": "string"
          }
        }
      },
      "Fund": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "churchId": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "isDefault": {
            "type": "boolean"
          }
        }
      },
      "FundDonation": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "churchId": {
            "type": "string"
          },
          "donationId": {
            "type": "string"
          },
          "fundId": {
            "type": "string"
          },
          "amount": {
            "type": "number"
          }
        }
      },
      "Gateway": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "churchId": {
            "type": "string"
          },
          "provider": {
            "type": "string"
          },
          "publicKey": {
            "type": "string"
          },
          "privateKey": {
            "type": "string"
          },
          "webhookUrl": {
            "type": "string"
          }
        }
      },
      "SubscriptionFund": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "churchId": {
            "type": "string"
          },
          "subscriptionId": {
            "type": "string"
          },
          "fundId": {
            "type": "string"
          },
          "amount": {
            "type": "number"
          }
        }
      }
    }
  },
  "tags": [
    {
      "name": "Customers",
      "description": "Customer management for payment processing"
    },
    {
      "name": "Donations",
      "description": "Donation processing and management"
    },
    {
      "name": "Donation Batches",
      "description": "Batch processing of donations"
    },
    {
      "name": "Event Logs",
      "description": "Transaction and event logging"
    },
    {
      "name": "Funds",
      "description": "Fund management for donations"
    },
    {
      "name": "Fund Donations",
      "description": "Fund allocation for donations"
    },
    {
      "name": "Gateways",
      "description": "Payment gateway configuration"
    },
    {
      "name": "Payment Methods",
      "description": "Credit cards and bank account management"
    },
    {
      "name": "Subscriptions",
      "description": "Recurring donation subscriptions"
    },
    {
      "name": "Subscription Funds",
      "description": "Fund allocation for recurring donations"
    }
  ]
}